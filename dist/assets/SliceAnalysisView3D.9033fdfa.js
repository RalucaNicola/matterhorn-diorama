import{lF as Ie,lq as ze,e as r,d as l,aP as he,jZ as K,n as W,dg as We,lG as Q,lH as J,lI as Me,ls as pe,j1 as Fe,lJ as ke,ei as x,ec as S,ee as c,e8 as ge,ea as Ue,ef as Ge,ek as je,e9 as ye,kL as A,dL as m,iU as He,eg as Be,iV as qe,lK as Ye,dR as $,el as O,fd as Xe,eo as h,dW as ve,ep as Ze,eq as we,er as me,es as _e,eu as fe,ic as Ke,ev as Qe,ew as Je,iY as L,ey as ei,ez as ii,eA as be,lL as ti,bn as ee,ld as b,bm as ai,a6 as si,g8 as E,bT as ri,et as ni,kM as li,en as N,jd as oi,bR as R,dM as di,ib as ci,dO as ui,dS as hi,dT as pi,dP as gi,i6 as yi,aY as vi,kN as M,gm as ie,r as d,dI as wi,a8 as Ce,lM as F,t as u,kK as mi,ka as j,g9 as D,lN as $e,lO as te,lP as Se,lQ as q,lR as _i,lS as H,lT as fi,ki as ae,aO as se,lU as bi,cx as Ci,y as Y,u as Ee,z as re,q as f,aK as B,U as ne,b as I,aL as $i,lV as Si,lW as le,fR as Ei,kP as Pi,lX as Vi}from"./index.165b2b59.js";import{n as Oi,g as Ti,b as Ni,a as Li,p as xi}from"./LineVisualElement.2ea00164.js";import{w as V}from"./persistable.7e2c3664.js";import{E as Ai}from"./BuildingComponentSublayer.8c7de568.js";import"./ImageMaterialTechnique.808c229a.js";let y=class extends Ie(We){constructor(e){super(e),this.type="plane",this.position=null,this.heading=0,this.tilt=0,this.width=10,this.height=10}equals(e){return this.heading===e.heading&&this.tilt===e.tilt&&ze(this.position,e.position)&&this.width===e.width&&this.height===e.height}};r([l({readOnly:!0,json:{read:!1,write:!0}})],y.prototype,"type",void 0),r([l({type:he}),V()],y.prototype,"position",void 0),r([l({type:Number,nonNullable:!0,range:{min:0,max:360}}),V(),K(e=>Q.normalize(J(e),0,!0))],y.prototype,"heading",void 0),r([l({type:Number,nonNullable:!0,range:{min:0,max:360}}),V(),K(e=>Q.normalize(J(e),0,!0))],y.prototype,"tilt",void 0),r([l({type:Number,nonNullable:!0}),V()],y.prototype,"width",void 0),r([l({type:Number,nonNullable:!0}),V()],y.prototype,"height",void 0),y=r([W("esri.analysis.SlicePlane")],y);const Pe=y;Me();pe();Fe();new he({x:0,y:0,z:0,spatialReference:null});function Ri(e,i){if(!i.screenSizeEnabled)return;const a=e.vertex;ke(a.uniforms,i),a.uniforms.add(new x("perScreenPixelRatio",S.Pass,(t,s)=>s.camera.perScreenPixelRatio)),a.uniforms.add(new x("screenSizeScale",S.Pass,t=>t.screenSizeScale)),a.code.add(c`float computeRenderPixelSizeAt( vec3 pWorld ){
vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);
float viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));
return viewDirectionDistance * perScreenPixelRatio;
}
vec3 screenSizeScaling(vec3 position, vec3 anchor){
return position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;
}`)}function Di(e){const i=new ge;i.include(Ue),i.include(Ri,e),i.include(Ge,e);const{vertex:a,fragment:t}=i;return t.include(je),ye(i,e),t.uniforms.add(new A("uColor",S.Pass,s=>s.color)),i.attributes.add(m.POSITION,"vec3"),i.varyings.add("vWorldPosition","vec3"),e.hasMultipassTerrain&&i.varyings.add("depth","float"),e.screenSizeEnabled&&i.attributes.add(m.OFFSET,"vec3"),e.shadingEnabled&&(a.uniforms.add(new He("viewNormal",S.Pass,(s,o)=>o.camera.viewInverseTransposeMatrix)),i.attributes.add(m.NORMAL,"vec3"),i.varyings.add("vViewNormal","vec3")),a.code.add(c`
    void main(void) {
      vWorldPosition = ${e.screenSizeEnabled?"screenSizeScaling(offset, position)":"position"};
  `),e.shadingEnabled&&a.code.add(c`vec3 worldNormal = normal;
vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`),a.code.add(c`
    ${e.hasMultipassTerrain?"depth = (view * vec4(vWorldPosition, 1.0)).z;":""}
    gl_Position = transformPosition(proj, view, vWorldPosition);
  }
  `),i.include(Be,e),t.code.add(c`
    void main() {
      discardBySlice(vWorldPosition);
      ${e.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":""}
    `),e.shadingEnabled?(t.uniforms.add(new qe("shadingDirection",S.Pass,s=>s.shadingDirection)),t.uniforms.add(new A("shadedColor",S.Pass,s=>Ii(s.shadingTint,s.color))),t.code.add(c`vec3 viewNormalNorm = normalize(vViewNormal);
float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);
vec4 finalColor = mix(uColor, shadedColor, shadingFactor);`)):t.code.add(c`vec4 finalColor = uColor;`),t.code.add(c`
      if (finalColor.a < ${c.float(Ye)}) {
        discard;
      }
      ${e.output===$.Alpha?c`gl_FragColor = vec4(finalColor.a);`:""}

      ${e.output===$.Color?c`gl_FragColor = highlightSlice(finalColor, vWorldPosition); ${e.transparencyPassType===O.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}`:""}
    }
    `),i}function Ii(e,i){const a=1-e[3],t=e[3]+i[3]*a;return t===0?(_[3]=t,_):(_[0]=(e[0]*e[3]+i[0]*i[3]*a)/t,_[1]=(e[1]*e[3]+i[1]*i[3]*a)/t,_[2]=(e[2]*e[3]+i[2]*i[3]*a)/t,_[3]=i[3],_)}const _=Xe(),zi=Object.freeze(Object.defineProperty({__proto__:null,build:Di},Symbol.toStringTag,{value:"Module"}));class X extends me{initializeProgram(i){const a=X.shader.get().build(this.configuration);return new _e(i.rctx,a,Wi)}_setPipelineState(i){const a=this.configuration,t=i===O.NONE,s=i===O.FrontFace;return fe({blending:a.output!==$.Color&&a.output!==$.Alpha||!a.transparent?null:t?Ke:Qe(i),culling:Je(a.cullFace),depthTest:{func:s?L.LESS:a.shadingEnabled?L.LEQUAL:L.LESS},depthWrite:t?a.writeDepth&&ei:ii(i),colorWrite:be,polygonOffset:t||s?null:ti})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}}X.shader=new we(zi,()=>import("./ShadedColorMaterial.glsl.89558c87.js"));class p extends Ze{constructor(){super(...arguments),this.output=$.Color,this.cullFace=ve.None,this.transparencyPassType=O.NONE,this.hasSlicePlane=!1,this.transparent=!1,this.writeDepth=!0,this.screenSizeEnabled=!0,this.shadingEnabled=!0,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}}r([h({count:$.COUNT})],p.prototype,"output",void 0),r([h({count:ve.COUNT})],p.prototype,"cullFace",void 0),r([h({count:O.COUNT})],p.prototype,"transparencyPassType",void 0),r([h()],p.prototype,"hasSlicePlane",void 0),r([h()],p.prototype,"transparent",void 0),r([h()],p.prototype,"writeDepth",void 0),r([h()],p.prototype,"screenSizeEnabled",void 0),r([h()],p.prototype,"shadingEnabled",void 0),r([h()],p.prototype,"hasMultipassTerrain",void 0),r([h()],p.prototype,"cullAboveGround",void 0);const Wi=new Map([[m.POSITION,0],[m.NORMAL,1],[m.OFFSET,2]]);function Mi(e,i,a,t){const s=ee(b.get(),e),o=ee(b.get(),i),n=ai(b.get(),s,o);return t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=0,t[4]=o[0],t[5]=o[1],t[6]=o[2],t[7]=0,t[8]=n[0],t[9]=n[1],t[10]=n[2],t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t}si("mac");const Fi=.7,P=ri(1,.5,0),ki=2,Ve=1,Oe=E([...P,Fi]),Te=[0,0,0,.04],Ne=E([...P,.5]);E([...P,1]);E([...P,1]);E([...P,1]);E([...P,1]);function Ui(e){const i=new ge;return i.extensions.add("GL_OES_standard_derivatives"),ye(i,e),i.attributes.add(m.POSITION,"vec3"),i.attributes.add(m.UV0,"vec2"),i.varyings.add("vUV","vec2"),i.vertex.code.add(c`void main(void) {
vUV = uv0;
gl_Position = proj * view * vec4(position, 1.0);
}`),i.fragment.uniforms.add(new A("backgroundColor")),i.fragment.uniforms.add(new A("gridColor")),i.fragment.uniforms.add(new x("ratio")),i.fragment.uniforms.add(new x("gridWidth")),i.fragment.code.add(c`void main() {
const float LINE_WIDTH = 1.0;
vec2 uvScaled = vUV * gridWidth;
vec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));
vec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);
grid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);
grid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);
float gridFade = max(grid.x, grid.y);
float gridAlpha = gridColor.a * gridFade;
gl_FragColor =
vec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +
vec4(gridColor.rgb, 1.0) * gridAlpha;
}`),i}const Gi=Object.freeze(Object.defineProperty({__proto__:null,build:Ui},Symbol.toStringTag,{value:"Module"}));class ji extends oi{constructor(){super(...arguments),this.backgroundColor=R(1,0,0,.5),this.gridColor=R(0,1,0,.5),this.gridWidth=4}}class k extends me{initializeProgram(i){const a=k.shader.get().build(this.configuration);return new _e(i.rctx,a,ni)}bindPass(i,a){this.program.bindPass(i,a),this.program.setUniform4fv("backgroundColor",i.backgroundColor),this.program.setUniform4fv("gridColor",i.gridColor),this.program.setUniform1f("gridWidth",i.gridWidth)}initializePipeline(){return fe({blending:li(N.ONE,N.ONE,N.ONE_MINUS_SRC_ALPHA,N.ONE_MINUS_SRC_ALPHA),depthTest:{func:L.LESS},colorWrite:be})}}k.shader=new we(Gi,()=>import("./SlicePlaneMaterial.glsl.e84281f6.js"));class Hi extends di{constructor(i){super(i,new qi),this._config=new ci}intersect(i,a,t,s,o,n,T){return ui(i,a,s,o,n,void 0,T)}createBufferWriter(){return new hi(pi)}requiresSlot(i){return i===gi.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL}createGLMaterial(i){return i.output===$.Color?new Bi(i):null}getConfiguration(){return this._config}}class Bi extends yi{constructor(i){super(i),this.ensureTechnique(k,null)}beginSlot(){return vi(this.technique)}}class qi extends ji{constructor(){super(...arguments),this.renderOccluded=M.Occlude}}class Yi extends Oi{constructor(i){super(i),this._material=null,this._renderOccluded=M.OccludeAndTransparent,this._gridWidth=1,this._gridColor=R(1,0,0,1),this._backgroundColor=R(1,0,0,1),this.applyProps(i)}get renderOccluded(){return this._renderOccluded}set renderOccluded(i){i!==this._renderOccluded&&(this._renderOccluded=i,this._updateMaterial())}get gridWidth(){return this._gridWidth}set gridWidth(i){this._gridWidth!==i&&(this._gridWidth=i,this._updateMaterial())}get gridColor(){return this._gridColor}set gridColor(i){ie(this._gridColor,i),this._updateMaterial()}get backgroundColor(){return this._backgroundColor}set backgroundColor(i){ie(this._backgroundColor,i),this._updateMaterial()}createExternalResources(){this._material=new Hi(this.materialParameters)}destroyExternalResources(){this._material=null}forEachExternalMaterial(i){d(this._material)&&i(this._material)}createGeometries(i){if(d(this._material)){const a=wi.createSquareGeometry();i.addGeometry(a,this._material)}}get materialParameters(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded}}_updateMaterial(){d(this._material)&&this._material.setParameters(this.materialParameters)}}const Xi=Ce.getLogger("esri.views.3d.interactive.analysisTools.slice.sliceToolUtils");function Zi(e,i,a){const t=i.worldUpAtPosition(e.origin,b.get()),s=e.basis1,o=Le(e,t),n=Math.round(o/z)*z;return H(e,n-o,s,a)}function Ki(e,i){return Mi(e.basis1,e.basis2,e.origin,i)}var oe;function Qi(e){const i=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]];return new Ti({view:e,attached:!0,color:Oe,width:Ve,writeDepthEnabled:!1,renderOccluded:M.OccludeAndTransparent,geometry:[i]})}function Ji(e){return new Yi({view:e,attached:!0,backgroundColor:[...Te],gridColor:Ne,gridWidth:4,renderOccluded:M.OccludeAndTransparent})}function et(e,i,a,t=new Pe){if(u(e))return null;const{renderCoordsHelper:s}=i,o=s.fromRenderCoords(e.origin,i.spatialReference);if(u(o))return null;const n=mi(o,a);if(u(n))return null;t.position=n;const T=s.worldUpAtPosition(e.origin,b.get()),Ae=s.worldBasisAtPosition(e.origin,j.Y,b.get()),Re=2*D(e.basis1),De=2*D(e.basis2),Z=$e.renderUnitScaleFactor(i.spatialReference,a);return t.width=Re*Z,t.height=De*Z,t.tilt=te(Le(e,T)),t.heading=te(it(e,T,Ae)),t}function Le(e,i){return Se(i,e.basis2,e.basis1)+z}function it(e,i,a){return Se(e.basis1,a,i)-z}function tt(e,i,a,t,s,o,n=q()){return o.toRenderCoords(e,n.origin)?(o.worldBasisAtPosition(n.origin,j.X,n.basis1),o.worldBasisAtPosition(n.origin,j.Y,n.basis2),_i(n.basis2,n.basis1,n.origin,n.plane),H(n,-ae(i),fi(n),n),H(n,ae(a),n.basis1,n),se(n.basis1,n.basis1,t/2),se(n.basis2,n.basis2,s/2),bi(n),n):(Xi.error(`Failed to project slice plane position, projection from ${e.spatialReference.wkid} is not supported`),null)}function at(e,i){if(u(e)||u(e.position))return null;const a=Ni(e.position,i.spatialReference,i.elevationProvider);if(u(a))return null;const t=$e.renderUnitScaleFactor(e.position.spatialReference,i.spatialReference),s=e.width*t,o=e.height*t;return{position:a,heading:e.heading,tilt:e.tilt,renderWidth:s,renderHeight:o}}function st(e,i,a,t=q()){if(u(e))return null;const s=tt(e.position,e.heading,e.tilt,e.renderWidth,e.renderHeight,i.renderCoordsHelper,t);return!a.tiltEnabled&&d(s)&&Zi(s,i.renderCoordsHelper,s),s}function rt(e){switch(e.type){case"analysis":case"building-scene":case"csv":case"feature":case"geo-rss":case"geojson":case"graphics":case"group":case"integrated-mesh":case"kml":case"map-notes":case"ogc-feature":case"point-cloud":case"route":case"scene":case"stream":case"voxel":case"subtype-group":case"unknown":case"unsupported":case"wfs":case null:return!1;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"elevation":case"georeferenced-image":case"imagery":case"imagery-tile":case"map-image":case"open-street-map":case"tile":case"vector-tile":case"wcs":case"web-tile":case"wms":case"wmts":return!0;default:return Ci(e.type),!1}}(function(e){e[e.POSITIVE_X=0]="POSITIVE_X",e[e.POSITIVE_Y=1]="POSITIVE_Y",e[e.NEGATIVE_X=2]="NEGATIVE_X",e[e.NEGATIVE_Y=3]="NEGATIVE_Y"})(oe||(oe={}));F.Custom1;var de,ce;(function(e){e[e.HEADING=1]="HEADING",e[e.TILT=2]="TILT"})(de||(de={})),function(e){e[e.HORIZONTAL_OR_VERTICAL=0]="HORIZONTAL_OR_VERTICAL",e[e.HORIZONTAL=1]="HORIZONTAL",e[e.VERTICAL=2]="VERTICAL",e[e.TILTED=3]="TILTED"}(ce||(ce={}));F.Custom2;pe();const z=Math.PI/2;F.Custom1;F.Custom2;var ue;function nt(e){const i=e.type==="building-scene-3d"?e:null;return d(i)}(function(e){e[e.CENTER_ON_CALLOUT=0]="CENTER_ON_CALLOUT",e[e.CENTER_ON_ARROW=1]="CENTER_ON_ARROW"})(ue||(ue={}));const U=Ce.getLogger("esri.views.3d.analysis.Slice.SliceController");let v=class extends Y{constructor(e){super(e),this._handles=new Ee,this._internalChange=!1,this._currentSlicePlane=null,this.state="ready"}get ready(){return this.state==="ready"}initialize(){this._handles.add(this.analysis.excludedLayers.on("before-add",e=>{const i=e.item;i!=null&&(i instanceof re||i instanceof Ai)?i instanceof re&&rt(i)?(U.error("excludedLayers",`Layer '${i.title}, id:${i.id}' of type '${i.type}' can not be individually excluded from slicing. Use 'excludeGroundSurface' instead.`),e.preventDefault()):this.analysis.excludedLayers.includes(i)&&e.preventDefault():(U.error("excludedLayers","Invalid layer type, layer must derive from Layer or BuildingComponentSublayer"),e.preventDefault())})),ot(this.view,this),this._handles.add([f(()=>this.analysisViewData.plane,()=>{this._internalChange||this._updateSlicePlaneFromBoundedPlane(),this._updateLayerViews()},{sync:!0}),f(()=>this.analysis.excludeGroundSurface,()=>this._updateLayerViews(),{sync:!0}),this.analysis.excludedLayers.on("change",()=>this._updateLayerViews()),f(()=>[this.analysisViewData.active,this.analysisViewData.visible],()=>{this._updateActiveController(),this._updateViewSlicePlane()},{sync:!0}),f(()=>this._allLayerAndSubLayerViews,()=>this._updateLayerViews())]),this._handles.add([f(()=>this.analysis.shape,()=>{this._internalChange||(this._updateBoundedPlaneFromSlicePlane(),this._updateViewSlicePlane())},{sync:!0})],"analysis"),this._set("state","ready"),this._updateActiveController(),this._updateBoundedPlaneFromSlicePlane(),this._updateViewSlicePlane()}destroy(){this.state!=="destroyed"&&(this.analysisViewData.active&&(this.analysisViewData.active=!1,this.view.slicePlane=null),dt(this.view,this),this._handles.destroy(),this.set("view",null),this._set("state","destroyed"))}async whenReady(){return await B(()=>this.ready),this}get _allLayerAndSubLayerViews(){const e=this.view.allLayerViews.items;return e.concat(e.filter(nt).flatMap(({sublayerViews:i})=>i.items))}_updateBoundedPlaneFromSlicePlane(){const e=this.analysis.shape,i=this._currentSlicePlane;if(u(i)&&u(e)||d(i)&&d(e)&&e.equals(i))return;let a=null,t=null;if(d(e)&&d(e.position)){const s=e.position.spatialReference,o=at(e,this.view);u(o)&&Li(this.analysis,s,U),a=st(o,this.view,{tiltEnabled:this.analysis.tiltEnabled},q()),d(a)&&(t={heading:e.heading,tilt:e.tilt,position:e.position,width:e.width,height:e.height})}this._currentSlicePlane=t,this._internalChange=!0,this.analysisViewData.plane=a,this._internalChange=!1}_updateSlicePlaneFromBoundedPlane(){const e=this.analysisViewData.plane,i=et(e,this.view,this.view.spatialReference,new Pe);let a=null;d(i)&&(a={heading:i.heading,tilt:i.tilt,position:i.position,width:i.width,height:i.height}),this._currentSlicePlane=a,this._internalChange=!0,this.analysis.shape=i,this._internalChange=!1,this._updateViewSlicePlane()}_updateActiveController(){if(G)return;const e=xe(this.view);if(this.analysisViewData.active)d(e.activeController)&&e.activeController!==this?(G=!0,e.activeController.analysisViewData.active=!1,G=!1):d(e.activeController)&&e.activeController,this._updateLayerViews(),e.activeController=this;else{if(d(e.activeController)&&e.activeController!==this)return;d(e.activeController)&&e.activeController===this&&(e.activeController=null,this._updateLayerViews())}}_updateViewSlicePlane(){this.state==="ready"&&lt(this.view)}_updateLayerViews(){const e=d(this.analysisViewData.plane)&&this.analysisViewData.visible&&this.analysisViewData.active,i=[],a=t=>{"layers"in t?t.layers.forEach(a):i.push(t)};this.analysis.excludedLayers.forEach(a),this.view.allLayerViews.forEach(t=>{t.destroyed||("slicePlaneEnabled"in t&&(t.slicePlaneEnabled=e&&!i.includes(t.layer)),"sublayerViews"in t&&t.sublayerViews.forEach(s=>{s.slicePlaneEnabled=e&&!i.includes(s.sublayer)}))}),this.view.basemapTerrain!=null&&(this.view.basemapTerrain.slicePlaneEnabled=e&&!this.analysis.excludeGroundSurface)}};r([l({readOnly:!0})],v.prototype,"state",void 0),r([l()],v.prototype,"view",void 0),r([l()],v.prototype,"analysis",void 0),r([l()],v.prototype,"analysisViewData",void 0),r([l()],v.prototype,"ready",null),r([l()],v.prototype,"_allLayerAndSubLayerViews",null),v=r([W("esri.views.3d.analysis.Slice.SliceController")],v);const C=new Map;let G=!1;function lt(e){const i=xe(e).activeController;d(i)&&d(i.analysisViewData.plane)&&i.analysisViewData.visible?e.slicePlane=i.analysisViewData.plane:e.slicePlane=null}function ot(e,i){C.has(e)||C.set(e,{all:[],activeController:null}),C.get(e).all.push(i)}function xe(e){return C.get(e)}function dt(e,i){if(!C.has(e))throw new Error("view expected in global slice register");const a=C.get(e),t=a.all.lastIndexOf(i);if(t===-1)throw new Error("controller expected in global slice register");a.all.splice(t,1),a.all.length===0&&C.delete(e)}let g=class extends Y{constructor(e){super(e),this._handles=new Ee,this._gridVisualElement=null,this._outlineVisualElement=null,this.state="pending",this.showGrid=!1,this.editable=!0}get ready(){return this.state==="ready"}initialize(){this._initialize()}async _initialize(){if(this.state==="destroyed"||this.state==="ready")return;await B(()=>this.view.ready);const e=this.analysisViewData;if(u(e))throw new Error("expected internal object to be valid");this._gridVisualElement=Ji(this.view),this._outlineVisualElement=Qi(this.view),this._handles.add([f(()=>({visible:d(e.plane)&&this.analysisViewData.visible,active:this.analysisViewData.active,editable:this.editable,showGrid:this.showGrid}),i=>this._updateMaterials(i),ne),f(()=>e.plane,i=>this._updatePlane(i),ne)],"internal"),this._set("state","ready")}destroy(){this.state!=="destroyed"&&this.state!=="pending"&&(this._handles.destroy(),this._gridVisualElement=I(this._gridVisualElement),this._outlineVisualElement=I(this._outlineVisualElement),this.set("view",null),this._set("state","destroyed"))}async whenReady(){await B(()=>this.view.ready)}_updatePlane(e){if(u(e))return;const i=$i(b.get(),D(e.basis1),D(e.basis2),1),a=Si(le.get(),i),t=Ki(e,le.get()),s=Ei(a,t,a);this._outlineVisualElement.transform=s,this._gridVisualElement.transform=s}_updateMaterials({visible:e,active:i,editable:a,showGrid:t}){this._outlineVisualElement.color=Oe,this._outlineVisualElement.width=a?Ve:ki,this._outlineVisualElement.stipplePattern=i?null:Pi(5),this._gridVisualElement.backgroundColor=Te,this._gridVisualElement.gridColor=t?Ne:Vi,this._gridVisualElement.visible=e,this._outlineVisualElement.visible=e}};r([l({readOnly:!0})],g.prototype,"state",void 0),r([l()],g.prototype,"view",void 0),r([l()],g.prototype,"analysis",void 0),r([l()],g.prototype,"analysisViewData",void 0),r([l()],g.prototype,"ready",null),r([l()],g.prototype,"showGrid",void 0),r([l()],g.prototype,"editable",void 0),g=r([W("esri.views.3d.analysis.Slice.SliceVisualization")],g);let w=class extends xi(Y){constructor(e){super(e),this.type="slice-view-3d",this.analysisVisualization=null,this.analysisController=null,this.plane=null,this.active=!0,this.showGrid=!1,this.editable=!1}initialize(){this.analysisVisualization=new g({view:this.view,analysis:this.analysis,analysisViewData:this}),this.analysisController=new v({view:this.view,analysis:this.analysis,analysisViewData:this})}destroy(){this.analysisVisualization=I(this.analysisVisualization),this.analysisController=I(this.analysisController)}async when(){return await this.analysisVisualization.whenReady(),await this.analysisController.whenReady(),this}get testData(){return{visualization:this.analysisVisualization,controller:this.analysisController}}};r([l()],w.prototype,"type",void 0),r([l()],w.prototype,"analysis",void 0),r([l()],w.prototype,"plane",void 0),r([l()],w.prototype,"active",void 0),r([l({aliasOf:"analysisVisualization.showGrid"})],w.prototype,"showGrid",void 0),r([l({aliasOf:"analysisVisualization.editable"})],w.prototype,"editable",void 0),w=r([W("esri.views.3d.analysis.SliceAnalysisView3D")],w);const ct=w;var vt=Object.freeze(Object.defineProperty({__proto__:null,default:ct},Symbol.toStringTag,{value:"Module"}));export{vt as S,Di as p,Ui as t};
